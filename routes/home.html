<div class="text-center">
  Welcome to...
  <h1>The Chat</h1>
</div>

<div class="w-full">
  <div class="flex flex-col gap-3 mx-auto max-w-2xl border-2 border-black rounded-lg p-3">
    <div id="wsStatus">Connecting...</div>
    <div class="flex flex-col h-96 overflow-y-scroll">

    </div>
    <input id="message" class="border-2 border-black rounded-lg w-full px-2 py-1" type="text"
      onkeypress="checkForEnter(event)" placeholder="Message" />
  </div>
</div>

<script>
  let message = document.getElementById('message');
  let wsStatus = document.getElementById('wsStatus');

  let ws = new WebSocket('ws://localhost:3000')

  ws.onopen = (ev) => {
    wsStatus.innerHTML = 'Connected'
  }

  ws.onmessage = (ev) => {
    console.log(ev.data);
  }

  ws.onclose = (ev) => {
    wsStatus.innerHTML = 'Disconnected'
  }

  /**
   * @param {KeyboardEvent} event
   */
  function checkForEnter(event) {
    if (event.code == "Enter") {
      submitMessage()
    }
  }

  async function submitMessage() {
    if (ws.readyState == ws.OPEN) {
      ws.send(message.value)
      message.value = ""
    }

  }

</script>